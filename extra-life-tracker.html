<html>
    <head>
        <link rel="stylesheet" href="styles.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

        <script>
            var positionInRotation = 0;
            var settings = {
                participantIds: ["<your participant Id>"],
                displayCount: 1,
                teamId: "",
                refreshTimeMS: 10000,
                fontColor: "#FFF",
                boarderColor: "#FFF",
                backgroundColor: "",
                opacity: 0.25,
                logWhenUpdating: false
            };

            var baseURL = "https://www.extra-life.org/index.cfm";

            function callAPI(data, callback) {
                data['format'] = 'json';

                $.ajax({
                    type: 'GET',
                    dataType: 'json',
                    url: baseURL,
                    data: data,
                    success: function(data) {
                        callback(data);
                    },
                    error: function(req, status, error) {
                        callback({});
                    }
                });
            }

            function makeParticipantTracker(participantData) {
                var tracker = $('<div/>', {class: 'participant-tracker-container'});
                var name = $('<div/>', {class: 'name'});
                var raised = $('<div/>', {class: 'raised'});

                tracker.appendTo('#participant-trackers');
                name.appendTo(tracker);
                raised.appendTo(tracker);

                name.html(participantData.displayName);
                raised.html("$" + participantData.totalRaisedAmount + "/$" + participantData.fundraisingGoal);

                return;
            }

            function updateParticipants() {
                var displayingParticipants = [];

                for (var i = 0; i < settings.displayCount; i++) {
                    displayingParticipants.push(settings.participantIds[positionInRotation]);

                    if (positionInRotation == settings.participantIds.length - 1) {
                        positionInRotation = 0;
                    } else {
                        positionInRotation = positionInRotation + 1;
                    }
                }

                var participantResults = [];

                for (var i = 0; i < displayingParticipants.length; i++) {
                    var params = {
                        fuseaction: 'donordrive.participant',
                        participantID: displayingParticipants[i]
                    };

                    callAPI(params, function(result) {
                        participantResults.push(result);

                        if (participantResults.length == displayingParticipants.length) {
                            if (settings.logWhenUpdating) {
                                console.log(participantResults);
                            }

                            $("#participant-trackers").html("");

                            for (var j = 0; j < displayingParticipants.length; j++) {
                                for (var k = 0; k < participantResults.length; k++) {
                                    if (participantResults[k].participantID == displayingParticipants[j]) {
                                        makeParticipantTracker(participantResults[k]);
                                    }
                                }
                            }
                        }
                    });
                }
            }

            function updateTeam() {
                var teamParams = {
                    fuseaction: 'donordrive.team',
                    teamID: settings.teamId
                };

                callAPI(teamParams, function(result) {
                    $("#team-name").html(result.name);
                    $("#team-raised").html(result.totalRaisedAmount);
                    $("#team-goal").html(result.fundraisingGoal);
                });
            }

            function update() {
                if (settings.logWhenUpdating) {
                    var newDate = new Date();
                    dateString = newDate.toUTCString();
                    console.log("Updating - " + dateString);
                }

                updateParticipants();

                if (settings.teamId != undefined && settings.teamId != "") {
                    updateTeam();
                }
            }

            $(document).ready(function() {
                var displayTeam = settings.teamId != undefined && settings.teamId != "";
                var displayHight = 55 * settings.displayCount + (displayTeam ? 30 : 0);

                if (!displayTeam) {
                    $("#tracking-team").hide();
                    $("#participant-trackers").css({ top: '2px' });
                }

                if (settings.displayCount > settings.participantIds.length || settings.displayCount < 1) {
                    settings.displayCount = settings.participantIds.length;
                }

                $("#tracking-container").css({
                    height: displayHight +'px',
                    color: settings.fontColor,
                    "border-color": settings.borderColor,
                    "background-color": settings.backgroundColor,
                    opacity: settings.opacity
                });

                update();
                setInterval(update, settings.refreshTimeMS);
            });
        </script>
    </head>

    <body>
        <div id="tracking-container">
            <div id="tracking-team">
                <div id="team-name" class="name"></div>:
                $<div id="team-raised" class="raised"></div>/$<div id="team-goal" class="goal"></div>
            </div>

            <div id="participant-trackers">
            </div>
        </div>
    </body>
</html>
